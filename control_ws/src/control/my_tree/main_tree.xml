<?xml version="1.0"?>
<root main_tree_to_execute="MainTree">
    <!-- ////////// -->
    <BehaviorTree ID="DoNavTree">
        <Parallel failure_threshold="1" success_threshold="1">
            <Action ID="Nav" destination="{dest}" mode="{mode}" read_key="{nav_key}" write_key="{nav_key}"/>
            <Condition ID="IsNavKeyPress" key="{nav_key}"/>
        </Parallel>
    </BehaviorTree>
    <!-- ////////// -->
    <BehaviorTree ID="DoSlamTree">
        <Parallel failure_threshold="1" success_threshold="1">
            <Action ID="LIOSAM" mode="{mode}" read_key="{liosam_key}" write_key="{liosam_key}"/>
            <Condition ID="IsLiosamKeyPress" key="{liosam_key}"/>
        </Parallel>
    </BehaviorTree>
    <!-- ////////// -->
    <BehaviorTree ID="MainTree">
        <Fallback>
            <Sequence>
                <Condition ID="IsSlamMode" mode="{mode}"/>
                <SubTree ID="DoSlamTree" __shared_blackboard="true" mode="{mode}"/>
            </Sequence>
            <Sequence>
                <Condition ID="IsNavMode" mode="{mode}"/>
                <SubTree ID="DoNavTree" __shared_blackboard="true" destination="{dest}" mode="{mode}"/>
            </Sequence>
            <Action ID="Idle" destination="{dest}" mode="{mode}"/>
        </Fallback>
    </BehaviorTree>
    <!-- ////////// -->
    <TreeNodesModel>
        <SubTree ID="DoNavTree">
            <input_port default="false" name="__shared_blackboard"/>
            <input_port name="destination"/>
            <output_port name="mode"/>
        </SubTree>
        <SubTree ID="DoSlamTree">
            <input_port default="false" name="__shared_blackboard"/>
            <output_port name="mode"/>
        </SubTree>
        <Action ID="Idle">
            <output_port name="destination"/>
            <output_port name="mode"/>
        </Action>
        <Condition ID="IsLiosamKeyPress">
            <output_port name="key"/>
        </Condition>
        <Condition ID="IsNavKeyPress">
            <output_port name="key"/>
        </Condition>
        <Condition ID="IsNavMode">
            <input_port name="mode"/>
        </Condition>
        <Condition ID="IsSlamMode">
            <input_port name="mode"/>
        </Condition>
        <Action ID="LIOSAM">
            <output_port name="mode"/>
            <input_port name="read_key"/>
            <output_port name="write_key"/>
        </Action>
        <Action ID="Nav">
            <input_port name="destination"/>
            <output_port name="mode"/>
            <input_port name="read_key"/>
            <output_port name="write_key"/>
        </Action>
    </TreeNodesModel>
    <!-- ////////// -->
</root>
